import itertools
import random
import collections
import operator
import functools

from scipy import ndimage
import numpy as np
import matplotlib

# eval_sid2scene_label: {
#   1: 'aeroplane', 2: 'bicycle', 3: 'bird', 4: 'boat', 5: 'bottle', 6: 'bus', 7: 'car', 8: 'cat',
#   9: 'chair', 10: 'cow', 11: 'table', 12: 'dog', 13: 'horse', 14: 'motorbike', 15: 'person',
#   16: 'pottedplant', 17: 'sheep', 18: 'sofa', 19: 'train', 20: 'tvmonitor', 21: 'bag', 23: 'bed',
#   25: 'bench', 28: 'book', 34: 'building', 35: 'cabinet', 38: 'ceiling', 39: 'cloth', 40: 'computer',
#   42: 'cup', 45: 'door', 46: 'fence', 48: 'floor', 49: 'flower', 50: 'food', 53: 'grass',
#   54: 'ground', 56: 'keyboard', 58: 'light', 62: 'mountain', 63: 'mouse', 43: 'curtain', 70: 'platform',
#   82: 'sign', 69: 'plate', 74: 'road', 75: 'rock', 80: 'shelves', 81: 'sidewalk', 84: 'sky',
#   86: 'snow', 24: 'bedclothes', 92: 'track', 93: 'tree', 94: 'truck', 95: 'wall', 96: 'water',
#   97: 'window', 99: 'wood'}

PARULA99_INT = [
    (61, 38, 168), (63, 40, 176), (64, 43, 183), (65, 46, 190),  # head
    (66, 48, 197), (67, 51, 205), (68, 54, 211), (69, 57, 217),  # torso
    (70, 60, 223), (70, 64, 227), (71, 67, 231), (71, 71, 235),  # low_arm
    (71, 75, 238), (71, 78, 241), (71, 82, 244), (71, 85, 246),  # up_arm
    (71, 89, 248), (70, 93, 250), (69, 96, 251), (68, 100, 252),  # low_leg
    (66, 104, 253), (64, 108, 254), (61, 112, 254), (57, 116, 254),  # up_leg
    (53, 120, 253), (49, 124, 252), (47, 127, 250), (46, 131, 248),
    (45, 134, 246), (45, 138, 244), (44, 141, 241), (43, 145, 238),
    (40, 148, 236), (38, 151, 234), (37, 154, 231), (36, 157, 230),
    (34, 160, 228), (32, 163, 227), (30, 166, 225), (28, 169, 223),
    (25, 172, 220), (22, 174, 217), (17, 177, 214), (11, 179, 210),
    (4, 181, 206), (1, 183, 202), (0, 185, 198), (2, 187, 193),
    (9, 188, 189), (17, 190, 185), (26, 191, 180), (33, 192, 175),
    (39, 194, 171), (44, 195, 166), (47, 197, 161), (51, 198, 156),
    (55, 199, 151), (59, 201, 145), (65, 202, 139), (73, 203, 133),
    (81, 203, 126), (89, 204, 119), (97, 204, 112), (106, 204, 105),
    (115, 204, 98), (125, 204, 91), (134, 203, 84), (144, 202, 76),
    (153, 201, 69), (162, 200, 62), (171, 198, 56), (179, 197, 51),
    (188, 195, 46), (196, 193, 42), (204, 192, 39), (211, 190, 39),
    (218, 189, 40), (225, 187, 42), (231, 186, 46), (237, 185, 51),
    (243, 185, 57), (248, 186, 61), (252, 188, 61), (254, 191, 58),
    (254, 195, 56), (254, 199, 53), (253, 202, 50), (252, 207, 48),
    (250, 211, 46), (248, 215, 44), (247, 219, 42), (245, 223, 40),
    (244, 227, 38), (244, 231, 36), (244, 235, 34), (245, 239, 31),
    (246, 243, 28), (247, 247, 24), (249, 250, 20)]